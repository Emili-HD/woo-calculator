const data=JSON.parse(wpcc_vars.data),atributos=JSON.parse(wpcc_vars.atributos);export function calculoEncuadernado(a,e){a.calculosEncuadernado=[];const t=document.querySelector("div[data-name='acabado'] .wpcc-field-radios input[value=encuadernado]");if(t){let e=0;function n(){const t=document.querySelector("div[data-name='color'] .wpcc-field-radios input[name=color]:checked");if(t){let a=t.value;e="bn"===a?atributos.maquina.maquina[1]:atributos.maquina.maquina[0];const o=data.primas.preparacion_maquina;for(const a in o)if(e===o[a][0]){parseFloat(o[a][1]);break}var n=0;const r=data.primas.amortizacion;for(let a in r)if(e===r[a][0]){parseFloat(r[a][1]),parseFloat(r[a][5]),n=parseFloat(r[a][3]);break}}else{e=atributos.maquina.maquina[0],parseFloat(data.primas.preparacion_maquina[1][1]);const a=data.primas.amortizacion;for(let t in a)if(e===a[t][0]){parseFloat(a[t][1]),n=a[t][3];break}}let o;if(o="Copistería online"==productData.name?a.calculosInicialesCopisteria:a.customCalculosIniciales,0!==n)for(const t in o)for(const c in o[t].detalles)for(const i in o[t].detalles[c]){const l=data.primas.espiral;let d=o[t].cantidad,s=document.querySelector("input[name=impresion]:checked").value;const u=document.querySelectorAll("input[name=color_espiral]");function r(){function r(){let a=b.value;_=.09*a,E=.12*a;for(let e in data.primas.margen_papel)if(a>=data.primas.margen_papel[e][0]&&a<=data.primas.margen_papel[e][1]){const a=data.primas.margen_papel[e][2];v=2*_*a/100,q=2*E*a/100;break}}function u(){const a=parseInt(b.value),e=[61,121,181,241,301,361,421,461];for(let t in y)for(let n=0;n<e.length;n++)if(d<e[n]&&a>=y[t][0]&&a<=y[t][1]){g=a*parseFloat(y[t][n+2]);break}}let p,m=document.querySelector("input[name=color_espiral]:checked").value,f=d/s;for(let a in l)f>=l[a][5]&&m===l[a][2]&&(p=l[a]);p&&(p=p[6]);let _=0,v=0,E=0,q=0;const b=document.querySelector("input[name=cantidad__copias]");r(),b.addEventListener("input",r);const h=data.primas.tiempo_manipulado[12][0],k=o[t].cantidad;let F=k/h,S=12*F;const y=data.primas.escalado_encuadernacion;let g=0;u(),b.addEventListener("input",u);let I=parseFloat(p)+_+E+S,w=parseFloat(p)+v+q+g,C=o[t].detalles[c][i].impresiones,L=0,P=0,z=0,A=0;for(const a in C){let a=document.querySelector("input[name=papel_portada]:checked").value;const t=data.primas.books;let o=parseInt(b.value);for(let e in t)if(a==t[e][0]){A=parseFloat(t[e][2])*o;break}L=2*A;let r,c=.01,i=o/n,l=c+i;P=12*l,r="Fuji"===e?data.primas.precio_hora_producción_bn:data.primas.precio_hora_producción;for(let a in r)l>=r[a][2]&&l<=r[a][3]&&(z=l*r[a][0])}a.calculosEncuadernado[t]||(a.calculosEncuadernado[t]={cantidad:o[t].cantidad,detalles:{}}),a.calculosEncuadernado[t].detalles[c]||(a.calculosEncuadernado[t].detalles[c]={}),a.calculosEncuadernado[t].detalles[c][i]={tiempoProduccionEncuadernado:F,costePapelEncuadernado:A,costeEncuadernado:S,totalCosteEncuadernado:I,totalVentaEncuadernado:w,importePapel:L,costeImpresion:P,importeImpresion:z}}r(),u.forEach(a=>{a.addEventListener("change",r)})}}function o(){const a=document.querySelectorAll("div[data-name='color'] .wpcc-field-radios input[name=color]");a.forEach(a=>{a.addEventListener("change",n)})}n(),o()}}