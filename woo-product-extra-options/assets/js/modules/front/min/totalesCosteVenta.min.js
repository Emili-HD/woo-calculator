let data=JSON.parse(wpcc_vars.data),atributos=JSON.parse(wpcc_vars.atributos);export function customCalculoTotales(a,e,o,t){function l(){return{"1cara":0,"2caras":0}}a.customTotales=[];let s=l(),c=l(),r=l(),n=l(),i=l(),d=l(),u=l(),m;m="Copister\xeda online"==productData.name?a.calculosInicialesCopisteria:a.customCalculosIniciales;let p=document.querySelector(".wpcc-group-radios[data-name=cantos]"),$=document.querySelector(".wpcc-group-radios[data-name=laminado]"),C=document.querySelector(".wpcc-group-radios[data-name=hendido]");for(let _ in a.customCalculosImpresiones)for(let f in a.customCalculosImpresiones[_].detalles)for(let S in a.customCalculosImpresiones[_].detalles[f]){let T=document.querySelectorAll("input[name=acabado]"),I=document.querySelector("input[name=acabado][value=grapado_izquierda]"),P=0,E=0;function h(){let e=1;t&&(e=t.value);let o;for(var l=0;l<m.length;l++){o=m[l].cantidad,console.log(o);let _=a.customCalculosImpresiones[l].detalles[f][S]?.tiempoImpresion?.["1cara"]||0,T=a.customCalculosImpresiones[l].detalles[f][S]?.tiempoImpresion?.["2caras"]||0,I=a.customCalculosCortes[l].detalles[f][S]?.totalTiempoCorte||0,h=p&&a.customCalculosCantos[l].tiempoCantos||0,v=$&&a.customCalculosLaminados[l].detalles[f][S].tiempoLaminado||0,L=C&&a.customCalculosHendidos[l].detalles.tiempoHendido||0,b=C&&a.customCalculosHendidos[l].detalles.totalTiempoHendido||0,q=a.customCalculosPapeles[l].detalles[f][S]?.costeAmortizacionMantenimiento?.["1cara"]||0,A=a.customCalculosPapeles[l].detalles[f][S]?.costeAmortizacionMantenimiento?.["2caras"]||0,V=a.customCalculosPapeles[l].detalles[f][S].costePapel||0,g=a.customCalculosImpresiones[l].detalles[f][S]?.costeImpresion?.["1cara"]||0,y=a.customCalculosImpresiones[l].detalles[f][S]?.costeImpresion?.["2caras"]||0,k=a.customCalculosCortes[l].detalles[f][S]?.costeCorte||0,H=p&&a.customCalculosCantos[l].detalles.costeCantos||0,z=$&&a.customCalculosLaminados[l].detalles[f][S].costeLaminado||0,w=C&&a.customCalculosHendidos[l].detalles.costeHendido||0,F=a.customCalculosPapeles[l].detalles[f][S].importePapel||0,G=a.customCalculosImpresiones[l].detalles[f][S]?.importeImpresion?.["1cara"]||0,j=a.customCalculosImpresiones[l].detalles[f][S]?.importeImpresion?.["2caras"]||0,x=a.customCalculosCortes[l].detalles[f][S]?.importeCorte||0,M=p&&a.customCalculosCantos[l].detalles.importeCantos||0,U=$&&a.customCalculosLaminados[l].detalles[f][S].ventaLaminado||0,B=C&&a.customCalculosHendidos[l].detalles.ventaHendido||0,D=0,J=0,K=0,N=0,O=0,Q=document.querySelectorAll("input[name=acabado]"),R=document.querySelectorAll("input[name=impresion]"),W=document.querySelector("input[name=acabado][value=plastificado]"),X=document.querySelector("input[name=acabado][value=encuadernado]");a.calculosPlastificado;let Y=o;function Z(){let a=document.querySelector("input[name=acabado]:checked"),t=document.querySelector("input[name=impresion]:checked"),l={taladrar_1_agujero:1,taladrar_2_agujeros:2,taladrar_4_agujeros:4};if(a&&t&&null!=l[a.value]){let s=data.primas.preparacion_maquina,c=data.primas.tiempo_manipulado,r=data.primas.precio_hora_manipulado,n=a.value.replace(/_/g," ").toLowerCase();n=n.charAt(0).toUpperCase()+n.slice(1);let i=t.value,d=0;for(let u in l[a.value],s)if("Taladrar"===s[u][0]){for(let m in D=s[u][1],c){let p=c[m][1].toLowerCase();if((p=p.charAt(0).toUpperCase()+p.slice(1))===n){J=o/i*e/c[m][0];break}}for(let $ in N=12*(K=parseFloat(D)+parseFloat(J)).toFixed(2),r)K>=r[$][2]&&K<=r[$][3]&&(d=r[$][0]);O=K.toFixed(2)*d}}}t&&(Y=o*e),Z(),Q.forEach(a=>a.addEventListener("change",Z)),R.forEach(a=>a.addEventListener("change",Z));let aa=0,ae=0,ao=0,at=0,al=0;W&&W.checked&&(al=a.calculosPlastificado[l].detalles.tiempoProduccionPlastificado||0,aa=a.calculosPlastificado[l].detalles.costeFunda||0,ae=a.calculosPlastificado[l].detalles.costePlastificado||0,ao=a.calculosPlastificado[l].detalles.importeFunda||0,at=a.calculosPlastificado[l].detalles.importePlastificado||0);let as=0,ac=0,ar=0,an=0,ai=0,ad=0,au=0,am=0,ap=0;if(X&&X.checked&&(as=a.calculosEncuadernado[l].detalles[f][S].tiempoProduccionEncuadernado||0,an=a.calculosEncuadernado[l].detalles[f][S].costePapelEncudernado||0,ap=a.calculosEncuadernado[l].detalles[f][S].costeEncudernado||0,ar=a.calculosEncuadernado[l].detalles[f][S].costeImpresion||0,ac=a.calculosEncuadernado[l].detalles[f][S].totalTiempoImpresion||0,ai=a.calculosEncuadernado[l].detalles[f][S].costeImpresion||0,ad=a.calculosEncuadernado[l].detalles[f][S].costeImpresion||0,au=a.calculosEncuadernado[l].detalles[f][S].costeImpresion||0,am=a.calculosEncuadernado[l].detalles[f][S].costeImpresion||0),"Copister\xeda online"==productData.name){s["1cara"]=_+I+K+as+ac+al,s["2caras"]=T+I+K+as+ac+al,c["1cara"]=q+V+ar+an+au+k+P+N+aa+ae,c["2caras"]=A+V+ar+an+au+k+P+N+aa+ae,r["1cara"]=c["1cara"]-q,r["2caras"]=c["2caras"]-A;let a$=document.querySelector("input[name=color]:checked"),aC=a$?a$.value:null,a0=data.primas.escalado_bn,a_=data.primas.escalado_color;if("bn"===aC)for(let af in a0){let aS=parseFloat(a0[af][0]),aT=parseFloat(a0[af][1]),aI=parseFloat(a0[af][2]);if(Y>=aS&&Y<=aT){n["1cara"]=aI*Y,n["2caras"]=2*aI*Y,i["1cara"]=0,i["2caras"]=0,d["1cara"]=0,d["2caras"]=0,u["1cara"]=aI*Y,u["2caras"]=2*aI*Y;break}n["1cara"]=e*(q+F+G+x+ao+at+E+O+am+ai+ad),n["2caras"]=e*(A+F+j+x+ao+at+E+O+am+ai+ad),i["1cara"]=0,i["2caras"]=0,d["1cara"]=0,d["2caras"]=0,u["1cara"]=e*(q+F+G+x+ao+at+E+O+am+ai+ad),u["2caras"]=e*(A+F+j+x+ao+at+E+O+am+ai+ad)}else if("color"===aC)for(let aP in a_)Y>=parseFloat(a_[aP][0])&&Y<=parseFloat(a_[aP][1])&&(n["1cara"]=parseFloat(a_[aP][2])*Y,n["2caras"]=2*parseFloat(a_[aP][2])*Y,i["1cara"]=parseFloat(a_[aP][2])*Y,i["2caras"]=2*parseFloat(a_[aP][2])*Y,d["1cara"]=parseFloat(a_[aP][2])*Y,d["2caras"]=2*parseFloat(a_[aP][2])*Y,u["1cara"]=parseFloat(a_[aP][2])*Y,u["2caras"]=2*parseFloat(a_[aP][2])*Y)}else s["1cara"]=_+I+h+v+b+L,s["2caras"]=T+I+h+v+b+L,c["1cara"]=q+V+g+k+H+z+w+P+N+aa+2,c["2caras"]=A+V+y+k+H+z+w+P+N+aa+2,r["1cara"]=c["1cara"]-q,r["2caras"]=c["2caras"]-A,n["1cara"]=q+F+G+x+B+E+O+1,n["2caras"]=A+F+j+x+B+E+O+1,i["1cara"]=q+F+G+x+U+B+E+O+1,i["2caras"]=A+F+j+x+U+B+E+O+1,d["1cara"]=q+F+G+x+M+B+E+O+1,d["2caras"]=A+F+j+x+M+B+E+O+1,u["1cara"]=q+F+G+x+M+U+B+E+O+1,u["2caras"]=A+F+j+x+M+U+B+E+O+1;a.customTotales[l]||(a.customTotales[l]={cantidad:m[l].cantidad,detalles:{}}),a.customTotales[l].detalles[f]||(a.customTotales[l].detalles[f]={}),a.customTotales[l].detalles[f][S]?(a.customTotales[l].detalles[f][S]["1Cara"].totalTiempoProduccion=s["1cara"],a.customTotales[l].detalles[f][S]["1Cara"].totalCoste=c["1cara"],a.customTotales[l].detalles[f][S]["1Cara"].totalCosteSinAmortizacion=r["1cara"],a.customTotales[l].detalles[f][S]["1Cara"].totalVentaSinAcabados=n["1cara"],a.customTotales[l].detalles[f][S]["1Cara"].totalVentaSinCantos=i["1cara"],a.customTotales[l].detalles[f][S]["1Cara"].totalVentaSinLaminado=d["1cara"],a.customTotales[l].detalles[f][S]["1Cara"].totalVenta=u["1cara"],a.customTotales[l].detalles[f][S]["2Caras"].totalTiempoProduccion=s["2caras"],a.customTotales[l].detalles[f][S]["2Caras"].totalCoste=c["2caras"],a.customTotales[l].detalles[f][S]["2Caras"].totalCosteSinAmortizacion=r["2caras"],a.customTotales[l].detalles[f][S]["2Caras"].totalVentaSinAcabados=n["2caras"],a.customTotales[l].detalles[f][S]["2Caras"].totalVentaSinCantos=i["2caras"],a.customTotales[l].detalles[f][S]["2Caras"].totalVentaSinLaminado=d["2caras"],a.customTotales[l].detalles[f][S]["2Caras"].totalVenta=u["2caras"]):a.customTotales[l].detalles[f][S]={"1Cara":{totalTiempoProduccion:s["1cara"],totalCoste:c["1cara"],totalCosteSinAmortizacion:r["1cara"],totalVentaSinAcabados:n["1cara"],totalVentaSinCantos:i["1cara"],totalVentaSinLaminado:d["1cara"],totalVenta:u["1cara"]},"2Caras":{totalTiempoProduccion:s["2caras"],totalCoste:c["2caras"],totalCosteSinAmortizacion:r["2caras"],totalVentaSinAcabados:n["2caras"],totalVentaSinCantos:i["2caras"],totalVentaSinLaminado:d["2caras"],totalVenta:u["2caras"]}}}}T.forEach(e=>{e.addEventListener("change",()=>{I.checked?(P=a.calculosGrapado.costeGrapado,E=a.calculosGrapado.importeGrapado):(P=0,E=0),h()})}),t=document.querySelector("input[name=cantidad__copias]"),h();let v=document.querySelectorAll("input[name=color]");v.forEach(a=>{a.addEventListener("change",()=>{h()})}),t&&t.addEventListener("input",h)}return s}
