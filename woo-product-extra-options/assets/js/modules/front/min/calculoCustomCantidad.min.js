function getTamanoKey(a,t){return`${parseInt(a)}x${parseInt(t)}`}const data=JSON.parse(wpcc_vars.data),atributos=JSON.parse(wpcc_vars.atributos);export function calculoCustomCantidad(a,t){if(data.campos&&data.campos.cartulina){const o=data.campos.cartulina,e=data.campos.impresion,r=data.primas.materias.filter(a=>o.includes(a[0]));let s,n=new Set;"Copistería online"==productData.name?s=a.calculosInicialesCopisteria:(s=a.customCalculosIniciales,console.log("calculoIniciales:",s));for(let a in s)for(let t in s[a].detalles){const o=Object.keys(s[a].detalles[t]);o.forEach(a=>{const[t,o]=a.split("x").map(Number),e={alto:t,ancho:o};n.add(JSON.stringify(e))})}let c=Array.from(n).map(JSON.parse);if(0!==t){const a={};r.forEach(o=>{c.forEach(r=>{if("Copistería online"==productData.name){const s=document.querySelector("div[data-name='color'] .wpcc-field-radios input[name=color]:checked");let n=atributos.maquina.maquina[1];if(s){let a=s.value;n="bn"===a?atributos.maquina.maquina[1]:atributos.maquina.maquina[0]}const c=data.primas.copisteria;for(const s in c)if(n===c[s][0]&&parseFloat(c[s][2])===r.alto){let n=c[s][3],i=c[s][5],l=Math.ceil(t/n),p={};e.forEach(a=>{const t=`${a}cara${a>1?"s":""}`;p[t]=parseInt(a)*l}),a[o[0]]||(a[o[0]]={});const u=`${r.alto}x${r.ancho}`;a[o[0]][u]={orig:n,hojas:l,impresiones:p,corte:i}}}else{let s=Math.floor(o[3]/(parseInt(r.ancho)+8))*Math.floor(o[4]/(parseInt(r.alto)+8)),n=Math.floor(o[3]/(parseInt(r.alto)+8))*Math.floor(o[4]/(parseInt(r.ancho)+8)),c=Math.floor(o[3]/parseInt(r.ancho))+Math.floor(o[4]/parseInt(r.alto)+2),i=Math.floor(o[3]/parseInt(r.alto))+Math.floor(o[4]/parseInt(r.ancho)+2),l=s>n?s:n,p=l===s?c:i,u=Math.ceil(t/l),m=getTamanoKey(r.alto,r.ancho),f={};e.forEach(a=>{const t=`${a}cara${a>1?"s":""}`;f[t]=parseInt(a)*u}),a[o[0]]||(a[o[0]]={}),a[o[0]][m]={orig:l,hojas:u,impresiones:f,corte:p}}})});const o={};Object.keys(a).sort().forEach(t=>{o[t]=a[t]}),s.push({cantidad:t,detalles:o})}}}